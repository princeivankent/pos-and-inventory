<p-dialog
      header="Payment"
      [(visible)]="visible"
      [modal]="true"
      [style]="{ width: '420px' }"
      [closable]="!processing()"
      [closeOnEscape]="!processing()"
      (onHide)="onClose()"
    >
      <div class="payment-body">
        <div class="payment-total">
          <span>Total Amount</span>
          <span class="total-value">{{ totalAmount() | phpCurrency }}</span>
        </div>

        <div class="field">
          <label>Amount Received</label>
          <p-inputNumber
            [ngModel]="amountPaid()"
            (ngModelChange)="amountPaid.set($event)"
            mode="currency"
            currency="PHP"
            locale="en-PH"
            [min]="0"
            inputStyleClass="payment-input"
            styleClass="w-full"
            placeholder="Enter amount"
          />
        </div>

        <div class="quick-amounts">
          @for (amount of quickAmounts(); track amount) {
            <p-button
              [label]="amount | phpCurrency"
              [outlined]="true"
              severity="secondary"
              size="small"
              (onClick)="amountPaid.set(amount)"
            />
          }
        </div>

        <div class="change-display" [class.negative]="change() < 0">
          <span>{{ change() >= 0 ? 'Change' : 'Remaining' }}</span>
          <span class="change-value">{{ (change() >= 0 ? change() : -change()) | phpCurrency }}</span>
        </div>
      </div>

      <ng-template pTemplate="footer">
        <p-button
          label="Cancel"
          [text]="true"
          severity="secondary"
          [disabled]="processing()"
          (onClick)="onClose()"
        />
        <p-button
          [label]="processing() ? 'Processing...' : 'Complete Sale'"
          [icon]="processing() ? 'pi pi-spinner pi-spin' : 'pi pi-check'"
          [disabled]="change() < 0 || processing()"
          [loading]="processing()"
          (onClick)="onComplete()"
        />
      </ng-template>
    </p-dialog>
