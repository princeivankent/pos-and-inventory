<div class="cart-panel">
      <div class="cart-header">
        <h3>Cart ({{ cart.itemCount() }})</h3>
        @if (cart.items().length > 0) {
          <p-button
            label="Clear"
            [text]="true"
            severity="danger"
            size="small"
            (onClick)="cart.clear()"
          />
        }
      </div>

      <div class="cart-items">
        @if (cart.items().length === 0) {
          <div class="cart-empty">
            <i class="pi pi-shopping-cart"></i>
            <p>Cart is empty</p>
          </div>
        } @else {
          @for (item of cart.items(); track item.product.id) {
            <app-cart-item
              [item]="item"
              (quantityChanged)="cart.updateQuantity(item.product.id, $event)"
              (removed)="cart.removeItem(item.product.id)"
            />
          }
        }
      </div>

      @if (cart.items().length > 0) {
        <div class="cart-summary">
          <div class="summary-row">
            <span>Subtotal</span>
            <span>{{ cart.subtotal() | phpCurrency }}</span>
          </div>
          @if (cart.taxEnabled()) {
            <div class="summary-row">
              <span>VAT (12%)</span>
              <span>{{ cart.taxAmount() | phpCurrency }}</span>
            </div>
          }
          <div class="summary-row total">
            <span>Total</span>
            <span>{{ cart.total() | phpCurrency }}</span>
          </div>
          <p-button
            [label]="'Charge ' + (cart.total() | phpCurrency)"
            styleClass="w-full charge-btn"
            icon="pi pi-wallet"
            (onClick)="charge.emit()"
          />
        </div>
      }
    </div>
